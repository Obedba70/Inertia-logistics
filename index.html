<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inertia Logistics â€¢ Official Club Forum</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<style>
  :root { --bg: #0a0e1a; --card: #11131a; --orange: #ff6b00; --green: #00ff80; }
  * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', Arial; }
  body { background:var(--bg); color:#ccc; }
  .container { max-width:1100px; margin:0 auto; padding:15px; }
  header { background:#0d1117; padding:20px; text-align:center; border-bottom:5px solid var(--orange); }
  header h1 { color:var(--orange); font-size:42px; text-shadow:0 0 20px #ff6b00; letter-spacing:2px; }
  .btn { background:var(--orange); color:black; padding:12px 30px; border:none; border-radius:50px; font-weight:bold; cursor:pointer; font-size:16px; }
  .btn:hover { background:#ff8533; }
  .card { background:var(--card); border-radius:15px; padding:20px; margin:15px 0; border-left:4px solid var(--orange); }
  .shoutbox .card { border-left:none; border:2px solid var(--orange); }
  .shouts { height:400px; overflow-y:auto; background:#080a0f; padding:15px; border-radius:10px; }
  .shout { margin:10px 0; }
  .shout span { color:var(--green); font-weight:bold; }
  .input { width:100%; padding:14px; background:#1a1f2e; border:2px solid #333; color:white; border-radius:10px; margin-top:10px; }
  .topic-item { background:#161a26; padding:15px; margin:10px 0; border-radius:12px; display:flex; justify-content:space-between; align-items:center; cursor:pointer; }
  .topic-item:hover { background:#1f2536; }
  .ingame { color:var(--green); font-weight:bold; }
  .online-btn { position:fixed; top:15px; right:15px; background:var(--orange); color:black; padding:10px 20px; border-radius:30px; font-weight:bold; z-index:999; cursor:pointer; }
  .hidden { display:none; }
  .photo { max-width:100%; border-radius:10px; margin:10px 0; }
</style>
</head>
<body>

<div class="container">

<header>
  <h1>INERTIA LOGISTICS</h1>
  <p style="color:#666; margin-top:5px;">Drive with the Force. Choose Inertia.</p>
</header>

<!-- LOGIN -->
<div id="loginScreen">
  <div style="text-align:center; padding:100px 20px;">
    <h2 style="color:var(--orange); font-size:36px; margin-bottom:30px;">Official Club Forum</h2>
    <input type="email" id="email" placeholder="Email" class="input" style="width:320px; display:inline-block;"><br><br>
    <input type="password" id="password" placeholder="Password" class="input" style="width:320px; display:inline-block;"><br><br><br>
    <button class="btn" onclick="login()">LOGIN</button>
    <button class="btn" onclick="signup()">CREATE ACCOUNT</button>
  </div>
</div>

<!-- MAIN APP -->
<div id="app" class="hidden">
  <div class="online-btn" onclick="showOnline()">0 Online</div>

  <div class="card">
    <h2 style="color:var(--orange); margin-bottom:15px;">Forum Topics</h2>
    <button class="btn" onclick="newTopic()">+ New Topic</button>
    <div id="topicsList" style="margin-top:20px;">Loading topics...</div>
  </div>

  <div class="shoutbox">
    <div class="card">
      <h2 style="color:var(--orange); margin-bottom:15px;">Live Shoutbox</h2>
      <div class="shouts" id="shouts"></div>
      <input type="text" id="shoutText" class="input" placeholder="Type message and press Enter..." onkeypress="if(event.key==='Enter') shout()">
    </div>
  </div>
</div>

</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAnfQTsgdSf6c4Wty6XbN4xdkSVp7d3KvM",
  authDomain: "inertia-logistics.firebaseapp.com",
  projectId: "inertia-logistics",
  storageBucket: "inertia-logistics.firebasestorage.app",
  messagingSenderId: "478964604946",
  appId: "1:478964604946:web:8e9373cad36ceb88afb8cb"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

let uid = null;
let inGameName = "Driver";

auth.onAuthStateChanged(async user => {
  if (user) {
    uid = user.uid;
    document.getElementById("loginScreen").classList.add("hidden");
    document.getElementById("app").classList.remove("hidden");
    const doc = await db.collection("users").doc(uid).get();
    inGameName = doc.exists && doc.data().inGameName ? doc.data().inGameName : "Driver";
    loadTopics();
    loadShouts();
    updateOnline();
    setInterval(updateOnline, 10000);
  }
});

function login() { auth.signInWithEmailAndPassword(document.getElementById("email").value, document.getElementById("password").value).catch(e=>alert(e.message)); }
function signup() { auth.createUserWithEmailAndPassword(document.getElementById("email").value, document.getElementById("password").value)
  .then(()=>db.collection("users").doc(auth.currentUser.uid).set({inGameName:"Driver", joined:new Date()}))
  .catch(e=>alert(e.message)); }

async function shout() {
  const text = document.getElementById("shoutText").value.trim();
  if (!text) return;
  await db.collection("shouts").add({
    text, name: inGameName, uid, time: firebase.firestore.FieldValue.serverTimestamp()
  });
  document.getElementById("shoutText").value = "";
}

function loadShouts() {
  db.collection("shouts").orderBy("time","desc").limit(50).onSnapshot(s => {
    const div = document.getElementById("shouts");
    div.innerHTML = "";
    s.docs.reverse().forEach(d => {
      const m = d.data();
      div.innerHTML += `<div class="shout"><span class="ingame">${m.name} ðŸš›:</span> ${m.text}</div>`;
    });
  });
}

function loadTopics() {
  db.collection("topics").orderBy("lastPost","desc").onSnapshot(s => {
    const div = document.getElementById("topicsList");
    if (s.empty) { div.innerHTML = "<p>No topics yet. Create the first one!</p>"; return; }
    div.innerHTML = "";
    s.forEach(d => {
      const t = d.data();
      div.innerHTML += `
        <div class="topic-item" onclick="openTopic('${d.id}')">
          <div>
            <strong style="color:var(--orange); font-size:18px;">${t.title}</strong><br>
            <small>by ${t.author} â€¢ just now</small>
          </div>
          <div>â†’</div>
        </div>`;
    });
  });
}

function newTopic() {
  const title = prompt("Topic title:");
  if (!title) return;
  const content = prompt("First post content:");
  db.collection("topics").add({
    title, author: inGameName, content, lastPost: firebase.firestore.FieldValue.serverTimestamp(), replies: 0
  });
}

function updateOnline() {
  if (uid) db.collection("online").doc(uid).set({name: inGameName, time: Date.now()},{merge:true});
  db.collection("online").onSnapshot(s => {
    document.querySelector(".online-btn").innerHTML = `${s.size} Online`;
  });
}

function showOnline() {
  db.collection("online").get().then(s => {
    let list = "ðŸš› ONLINE DRIVERS ðŸš›\n\n";
    s.forEach(d => list += `â€¢ ${d.data().name}\n`);
    alert(list || "Nobody online");
  });
}
</script>

<center style="margin:50px; color:var(--orange); font-size:22px;">
